---
title: "[TOY] 가계부 만들기 6주차 : 리팩토링 및 기능 구현 마무리"
excerpt: "지난주에 마무리하려고 했는데 마무리는 커녕 어찌 해야할 일이 더 많아졌다."

categories:
  - TOY
tags:
  - toy-project
  - money-manager
  - vanila-javascript

date: 2022-12-05
last_modified_at: 2022-12-11
---

<br><br>

> #### 이번주 주간 목표
>
> 정리하다보니 클래스 구조부터, 디렉토리 구조, 함수구조까지 모두 엎어야겠다.<br>
> 이번주는 리팩토링을 끝내고 남은 기본 기능을 구현하는데 집중해보자.<br>
> 과연 이번주에는 목표한대로 진행할 수 있을까? 😂

<br><br>

## 2022.12.05 ~ 06

#### 리팩토링

디자인 시안을 보면서 각 페이지 네이밍과 컴포넌트 구조를 돌아봤다.<br>
동작 과정을 복기하며 그려보고,<br>
요소의 역할을 명확히 알 수 있도록 class명을 수정하고, 계층 구조를 정리했다.

![img01](https://user-images.githubusercontent.com/81657811/205822674-8fd163b0-e69e-4b3c-84db-de3b27ad09a7.jpeg)

class명은 Sass의 nesting 문법 사용이 용이하도록 하되, 너무 길어지지 않도록 적당히 끊어주었다.

```html
<section class="spend">
  <div class="spend-list">
    <ol class="spend-list-day">
      <li class="spend-list-day-item">
        <div class="detail-content">
          <div class="catagory">catagory</div>
          <div class="title">title</div>
        </div>
        <span class="memo">memo</span>
      </li>
    </ol>
  </div>
</section>
```

일단 위 코드같이 뎁스가 깊어지는 구조에서는 class명을 분리했는데<br>
spend-list-day-item-detail 뭐 이렇게 명확하게 이어주는게 맞는가 고민..

그리고 semantic markup을 위한 개선도 조금 진행했다.<br>
form, section, aside, aria-lable 등으로 일부 요소를 수정했다.<br>
[HTML <form> 잘 쓰는 법]

어제도 오늘도 계속 리팩토링 중.. 내일 되어야 마무리할 수 있을듯.<br>
아.. 고민에 고민을 거듭하느라 진도가 안나간다.<br>
머리 싸매고 고민하는 시간이 너무 길어진다.<br>
간단한 앱 만드는건데 이게 맞나.. 나는 바보가 아닐까.. 싶고<br>
나름 정리를 하는 중인데도 코드가 지저분하고 길다.<br>
당연히 지금 당장 유려한 코드를 착착 만들 수 없을 거라는걸 알지만<br>
걱정은 된다.. 이래도되나...<br>
일단.. 뚝심있게 꾸준히 길게보고 가보자.

<br><br>

## 2022.12.07

일단 리팩토링 끝!

css 클래스를 정리하고,<br>
함수 동작 구조도 처음부터 한줄 한줄 훑으면서 다듬었다.

바닐라 자바스크립트로 프로젝트를 만들다보니 대부분의 모듈을<br>
미리 만들어놓고 숨기는 방식으로 조작하다보니 이게 맞나 싶은 부분들이 많았다.

바닐라로 앱을 발전시키면서 작업해보려고 했는데,<br>
점점 복잡한 기능을 추가하려면 상태관리가 필요하므로<br>
리액트로 다시 만드는것이 여러모로 더 의미가 있겠다는 생각이 든다.<br>
(바닐라로 상태관리하는 글들을 찾아보면 넘나 멋져보이고 나도 해보고싶은데<br>
지금 나는 그럴 수 있는 단계가 아닌 것 같다.ㅎㅎㅎ)

어쨌든 낼은 남은 기능을 호로록 해치운다!

<br><br>

## 2022.12.08

#### 소비기록 날짜 기준 내림차순 정렬 (최신순)

원래 리스트가 가진 날짜 데이터를 비교할 목적으로 dateId라는 값을 활용중이었는데,<br>
`selectedYear`-`selectedMonth`-`selectedDate` 의 문자열 타입이었다.<br>
정렬을 위해서 `YYYYMMDD` 형태의 number type으로 변환시키는 함수를 먼저 만들었다.

```javascript
function getDateId() {
  const month = selectedMonth.toString().padStart(2, "0");
  const date = selectedDate.toString().padStart(2, "0");
  const fullDate = selectedYear + month + date;

  return parseInt(fullDate);
}
```

###### 첫번째 시도

리스트를 추가하면서 만들어진 모든 ol을 함수 안에 정의하고<br>
바로 sort 메소드를 붙이려고 했는데 에러가 났다.<br>
querySelectorAll로 잡아온 ol들이 NodeList의 형태로 저장되었기때문에 array로 변환하는 작업이 필요했다.<br>
(지금까진 NodeList에서도 사용 가능한 메소드만 써서 몰랐나보다.)

```javascript
const element = document.querySelectorAll(".element-class");
const elementArr = Array.prototype.slice.call(element);
```

그런데 이렇게하면 새로 정의한 elementArr가 정렬될뿐, UI가 조작되는 것이 아니므로 실패.

###### 두번째 시도

소비내역 저장을 누를떄, 입력한 값들을 잡아 spendList 객체로 만들어서 spend라는 배열에 push하고<br>
그 spend를 로컬에 저장하는 방식으로 작동한다.<br>
그러니까 spend 배열 자체를 정렬해야하는 것이 아닌가 하고 아래와 같이 작성해보았다.

```javascript
spends.push(spendList);
spends.sort((a, b) => b.dateId - a.dateId);
saveSpend();
generateSpendList(spendList);
```

spends 배열에 내용 객체를 추가하고, 정렬 한다음 로컬에 저장시켰다.<br>
그런데 이러면 의도한 순서대로 데이터 저장은 되지만, 새로고침 해서 리스트를 아예 새로 렌더해야만 화면에 반영이 되었다.<br>
그래서 처음 list가 생성될때 (appendChild 되는 순간)에도 dateId값을 비교해야한다.

이 부분에서 시간 마이 걸리는 중..

<br><br>

## 2022.12.09

#### 예산 추가 버튼 기능 구현

#### setting 버튼 기능 구현 (replace local data)

#### GNB 메뉴 구현

<br><br>

- 월이 바뀌어도 설정한 소비기간 마지막 날까지 데이터 유지
- 설정한 소비기간이 끝나고 다음 텀으로 넘어가면 기록은 별도 저장, 소비내역 리셋<br>
  but 소비 통계 등 새로운 디자인과 기능 기획 필요

[html <form> 잘 쓰는 법]: https://tecoble.techcourse.co.kr/post/2021-05-22-html-form-tag/
